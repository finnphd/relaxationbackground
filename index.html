<!DOCTYPE html>
<html>
<head>
    <title>Audio Player with Background Noise</title>
</head>
<body>
    <svg id="play" viewBox="0 0 200 200" style="margin: auto; width: 90vw; height: 90vh">
        <circle cx="100" cy="100" r="100" />
        <polygon fill="#FFFFFF" points="146.5,100 71.5,56.7 71.5,143.3" />
    </svg>

    <div id="noise-selector">
        <button id="play-white-noise">Play White Noise</button>
    </div>

    <script>
        // Existing code for audio playback
        if (typeof Audio !== "undefined") {
            const audioObj = new Audio("./Responsive Hypnosis Example.mp3");
            const playButton = document.getElementById('play');

            // ... (Existing code for audio playback)

            audioObj.addEventListener('error', function () {
                console.error('Audio could not be loaded.');
            });

            // Function to generate background noise
            function generateWhiteNoise() {
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const bufferSize = context.sampleRate * 2;
                const noiseBuffer = context.createBuffer(1, bufferSize, context.sampleRate);
                const output = noiseBuffer.getChannelData(0);

                for (let i = 0; i < bufferSize; i++) {
                    output[i] = Math.random() * 2 - 1;
                }

                const whiteNoiseSource = context.createBufferSource();
                whiteNoiseSource.buffer = noiseBuffer;
                whiteNoiseSource.loop = true;
                whiteNoiseSource.connect(context.destination);
                whiteNoiseSource.start();

                return whiteNoiseSource;
            }

            // Event listener for the "Play White Noise" button
            const whiteNoiseButton = document.getElementById('play-white-noise');
            whiteNoiseButton.addEventListener('click', () => {
                if (noiseNode) {
                    noiseNode.stop();
                }
                noiseNode = generateWhiteNoise();
            });

            let noiseNode;

        } else {
            console.error("Audio is not supported in this browser.");
        }
    </script>
</body>
</html>
